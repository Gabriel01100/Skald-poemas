{% extends "base.html" %}

{% block contenido %}

<form method="GET" id="filtro-form" action="{{ url_for('poemas.more') }}">
  <label class="etiqueta" for="filtro_etiqueta">Filtrar por etiqueta:</label>
  <select name="etiqueta" id="filtro_etiqueta">
    <option value="">-- Todas --</option>
    {% for etiqueta in etiquetas %}
      <option value="{{ etiqueta }}" {% if request.args.get("etiqueta") == etiqueta %}selected{% endif %}>{{ etiqueta }}</option>
    {% endfor %}
  </select>
</form>

<section id="lista-poemas" class="poemas">
  {% for poema in poemas %}
  <article class="poema">
    <h2>{{ poema.titulo }}</h2>

    <!-- Resumen inicial (primeras 200 letras aprox) -->
    <p id="resumen-{{ poema.id }}">
      {{ poema.contenido[:200] }}{% if poema.contenido|length > 200 %}...{% endif %}
    </p>

    <!-- Contenido completo oculto inicialmente -->
    {% if poema.contenido|length > 200 %}
    <p id="completo-{{ poema.id }}" style="display: none; white-space: pre-wrap;">
      {{ poema.contenido }}
    </p>
    <button onclick="mostrarPoema({{ poema.id }})" id="btn-{{ poema.id }}">Ver m√°s</button>
    {% endif %}
  </article>
  {% endfor %}
</section>


<script src="{{url_for('static', filename='JS/more.js')}}"></script>
{% endblock %}